<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Capturing Audio </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Capturing Audio ">
    
    
      <link rel="shortcut icon" href="../favicon.ico">
      <link rel="stylesheet" href="../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../styles/docfx.css">
      <link rel="stylesheet" href="../styles/main.css">
      <meta property="docfx:navrel" content="../toc.json">
      <meta property="docfx:tocrel" content="toc.json">
    
    <meta property="docfx:rel" content="../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>

                <ul class="nav level1 navbar-nav">
                      <li>
                          <a href="../articles/intro.html" title="Articles">Articles</a>
                      </li>
                      <li>
                          <a href="../api/index.html" title="Api Documentation">Api Documentation</a>
                      </li>
                </ul>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first=First data-prev=Previous data-next=Next data-last=Last></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">

                  <ul class="nav level1">
                    <li class="">
                      <a href="intro.html" title="Introduction" class="">Introduction</a>
                    </li>
                    <li class="">
                      <a href="EnumeratingAudioDevices.html" title="Enumerating Audio Devices" class="">Enumerating Audio Devices</a>
                    </li>
                    <li class="active">
                      <a href="CapturingAudio.html" title="Capturing Audio Samples" class="active">Capturing Audio Samples</a>
                    </li>
                    <li class="">
                      <a href="AudioOutput.html" title="Sending Audio to the Speakers or Headset" class="">Sending Audio to the Speakers or Headset</a>
                    </li>
                    <li class="">
                      <a href="MonitoringAudioDeviceStatus.html" title="Monitoring Audio Device Status" class="">Monitoring Audio Device Status</a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="capturing-audio">Capturing Audio</h1>

<p>Windows applications can use the WindowsAudioIo class to capture audio from a selected audio device such as the microphone of a headset by performing the following steps.</p>
<ol>
<li>Construct an instance of the WindowsAudioIo class.</li>
<li>Hook the AudioSamplesReady event</li>
<li>Call the StartAudio() method of the WindowsAudioIo object.</li>
</ol>
<p>If you are using the same audio device for input and output of audio, then you must use the same instance of the WindowsAudioIo class for both receiving (capturing) and sending audio samples to the speakers or the headset. See <a href="AudioOutput.html">Sending Audio to the Speakers or Headset</a>.</p>
<p>When the application needs to stop receiving audio, it should perform the following steps.</p>
<ol>
<li>Unhook the AudioSamplesReady event.</li>
<li>Call the StopAudio() method of the WindowsAudioIo object.</li>
</ol>
<p>The declaration of the constructor for the WindowsAudioIo class is:</p>
<pre><code>public WindowsAudioIo(int SampleRate = 8000, string? DeviceName = null);
</code></pre>
<p>The SampleRate parameter must be either 8000 or 16000 samples per second. The DeviceName parameter must be one of the names returned by the GetAudioDeviceNames() method or null. If the DeviceName parameter is null, then the WaveAudioIo class will use the first audio device that it finds when the StartAudio() method is called.</p>
<p>The StartAudio() method returns a <a href="../api/SipLib.Audio.Windows.WaveAudioStatusEnum.html">WaveAudioStatusEnum</a> value to indicate success or failure. Return values of WaveAudioStatusEnum.Success and WaveAudioStatusEnum.AlreadyStarted indicate that audio sampling has been successfully started.</p>
<p>The delegate type for the AudioSamplesReady event is:</p>
<pre><code>public delegate void AudioInSamplesReadyDelegate(short[] PcmSamples);
</code></pre>
<p>The PcmSamples parameter will contain 160 linear PCM 16-bit audio samples if the SampleRate specified in the constructor was 8000 or 320 samples if the specified sample rate was 16000. This event is fired every 20 milliseconds.</p>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
