{
  "README.html": {
    "href": "README.html",
    "title": "SipLib.Video.Windows Class Library Documentation",
    "summary": "SipLib.Video.Windows Class Library Documentation This directory contains the GitHub Pages documentation project for the SipLib.Video.Windows class library. This is a DocFX project so DocFX must be installed on you system before you can build the documentation GitHub Pages static web site for the SipLib.Video.Windows project. To build the documentation, open a command prompt and change to the the SipLib.Video.Windows directory and then type docfx."
  },
  "api/SipLib.Audio.Windows.AudioDeviceStateChangedDelegate.html": {
    "href": "api/SipLib.Audio.Windows.AudioDeviceStateChangedDelegate.html",
    "title": "Delegate AudioDeviceStateChangedDelegate",
    "summary": "Delegate AudioDeviceStateChangedDelegate Delegate type for the AudioDeviceStateChanged event of the WindowsAudioIo class. Namespace: SipLib.Audio.Windows Assembly: SipLib.Audio.Windows.dll Syntax public delegate void AudioDeviceStateChangedDelegate(bool Connected) Parameters Type Name Description bool Connected If true then the audio I/O device is connected. Else, the audio I/O device is disconnected or not available."
  },
  "api/SipLib.Audio.Windows.AudioInSamplesReadyDelegate.html": {
    "href": "api/SipLib.Audio.Windows.AudioInSamplesReadyDelegate.html",
    "title": "Delegate AudioInSamplesReadyDelegate",
    "summary": "Delegate AudioInSamplesReadyDelegate Delegate type for the AudioInSamplesReady event of the WindowsAudioIo class. Namespace: SipLib.Audio.Windows Assembly: SipLib.Audio.Windows.dll Syntax public delegate void AudioInSamplesReadyDelegate(short[] PcmSamples) Parameters Type Name Description short[] PcmSamples Block of new samples from the microphone."
  },
  "api/SipLib.Audio.Windows.WaveAudioStatusEnum.html": {
    "href": "api/SipLib.Audio.Windows.WaveAudioStatusEnum.html",
    "title": "Enum WaveAudioStatusEnum",
    "summary": "Enum WaveAudioStatusEnum Enumeration for the values returned by the StartAudio method of the WindowsAudioIo class. Namespace: SipLib.Audio.Windows Assembly: SipLib.Audio.Windows.dll Syntax public enum WaveAudioStatusEnum Fields Name Description AlreadyStarted Audio has already been started. AudioDeviceNameNotFound The specified Wave API audio device is not available InvalidSampleRate The specified sample rate is not valid. Valid sample rates are 8000 or 16000 samples per second. NoAudioDevicesFound No Wave API audio devices are available Success Success"
  },
  "api/SipLib.Audio.Windows.WaveOutDest.html": {
    "href": "api/SipLib.Audio.Windows.WaveOutDest.html",
    "title": "Class WaveOutDest",
    "summary": "Class WaveOutDest Class that implements the NAudio IWaveProvider interface for the Wave API for the NAudio class library. Applications that use class library do not normally need to use this class. Inheritance object WaveOutDest Implements IWaveProvider Inherited Members object.Equals(object) object.Equals(object, object) object.GetHashCode() object.GetType() object.MemberwiseClone() object.ReferenceEquals(object, object) object.ToString() Namespace: SipLib.Audio.Windows Assembly: SipLib.Audio.Windows.dll Syntax public class WaveOutDest : IWaveProvider Constructors WaveOutDest(WaveFormat) Default constructor. Declaration public WaveOutDest(WaveFormat Wfmt) Parameters Type Name Description WaveFormat Wfmt WaveFormat object containing the format information for the audio samples. Properties WaveFormat Gets the WaveFormat object. Declaration public WaveFormat? WaveFormat { get; } Property Value Type Description WaveFormat Methods QueueSampleBlock(byte[]) Adds a block of samples to the sample block queue. These samples will be sent to the wave output when the wave API asks for more samples. Each sample block will contain 20 ms worth of audio. Each sample is 2 bytes long. Declaration public void QueueSampleBlock(byte[] SampleBlock) Parameters Type Name Description byte[] SampleBlock Byte array containing the next block of audio samples. Read(byte[], int, int) Called when the WAVE API needs byte to play to the output. Declaration public int Read(byte[] buffer, int offset, int count) Parameters Type Name Description byte[] buffer Location to put the new sample bytes. int offset Offset into buffer for the new sample bytes. int count Number of bytes to write into buffer. Note: Each sample is two bytes long. Returns Type Description int Returns the number of bytes actually written into buffer. Implements NAudio.Wave.IWaveProvider"
  },
  "api/SipLib.Audio.Windows.WindowsAudioIo.html": {
    "href": "api/SipLib.Audio.Windows.WindowsAudioIo.html",
    "title": "Class WindowsAudioIo",
    "summary": "Class WindowsAudioIo This class uses the Windows Wave API to capture audio from a microphone and to send audio to the speakers or a headset. It is intended for use with Voice Over IP (VoIP) applications running under Windows. Inheritance object WindowsAudioIo Implements IMMNotificationClient IAudioSampleSource Inherited Members object.Equals(object) object.Equals(object, object) object.GetHashCode() object.GetType() object.MemberwiseClone() object.ReferenceEquals(object, object) object.ToString() Namespace: SipLib.Audio.Windows Assembly: SipLib.Audio.Windows.dll Syntax public class WindowsAudioIo : IMMNotificationClient, IAudioSampleSource Constructors WindowsAudioIo(int, string?) Constructor Declaration public WindowsAudioIo(int SampleRate = 8000, string? DeviceName = null) Parameters Type Name Description int SampleRate Sample rate in samples per second. Must be either 8000 or 16000. The default is 8000. string DeviceName Specifies the audio device name as known by the Windows Wave API subsystem. The default is null. If null, then this class will pick the first available audio device. Properties SampleRate Gets the configured sample rate in samples/second. Declaration public int SampleRate { get; } Property Value Type Description int Methods AudioOutSamplesReady(short[]) Sends the received PCM samples to the output device (speakers or headset). Declaration public void AudioOutSamplesReady(short[] PcmSamples) Parameters Type Name Description short[] PcmSamples Received PCM samples (16-bit linear, 8000 or 16000 samples per second. GetAudioDeviceNames() Gets a list of available Wave API audio devices. Declaration public static List<string> GetAudioDeviceNames() Returns Type Description List<string> Returns a list of device names. The list will be empty if there are no audio devices available. OnDefaultDeviceChanged(DataFlow, Role, string) IMMNotificationClient interface method. Called by the Windows multi-media subsystem when the default audio device has changed. The user of this WindowsAudioIo object should never call this method. Declaration public void OnDefaultDeviceChanged(DataFlow flow, Role role, string defaultDeviceId) Parameters Type Name Description DataFlow flow Role role string defaultDeviceId OnDeviceAdded(string) IMMNotificationClient interface method. Called by the Windows multi-media subsystem when an audio device has been added to the system. The user of this WindowsAudioIo object should never call this method. Declaration public void OnDeviceAdded(string pwstrDeviceId) Parameters Type Name Description string pwstrDeviceId OnDeviceRemoved(string) IMMNotificationClient interface method. Called by the Windows multi-media subsystem when an audio device has been removed from the system. The user of this WindowsAudioIo object should never call this method. Declaration public void OnDeviceRemoved(string deviceId) Parameters Type Name Description string deviceId OnDeviceStateChanged(string, DeviceState) IMMNotificationClient interface method. Called by the Windows multi-media subsystem when the audio device state changes. The user of this WindowsAudioIo object should never call this method. Declaration public void OnDeviceStateChanged(string deviceId, DeviceState newState) Parameters Type Name Description string deviceId DeviceState newState OnPropertyValueChanged(string, PropertyKey) IMMNotificationClient interface method. Called by the Windows multi-media subsystem when a property of an audio device has changed. The user of this WindowsAudioIo object should never call this method. Declaration public void OnPropertyValueChanged(string pwstrDeviceId, PropertyKey key) Parameters Type Name Description string pwstrDeviceId PropertyKey key Start() Tells the audio sample source to start sending audio samples by firing the SendAudioSamples event. Declaration public void Start() StartAudio() Sets up audio acquisition from the microphone and gets ready to start sending audio to the speakers or headset. Declaration public WaveAudioStatusEnum StartAudio() Returns Type Description WaveAudioStatusEnum Returns Success if no errors were detected or an error code. Audio is not started if an error code is returned. Stop() Tells the audio sample source to stop sending audio samples. Declaration public void Stop() StopAudio() Call this method to stop the audio and gracefully shutdown. Declaration public void StopAudio() Events AudioDeviceStateChanged This event is fired when the state of the Windows audio I/O device changes state. Declaration public event AudioDeviceStateChangedDelegate? AudioDeviceStateChanged Event Type Type Description AudioDeviceStateChangedDelegate AudioSamplesReady This event is fired when a full block of 20 milliseconds of audio data has been received from the microphone. Each sample point is a PCM sample (16-bit linear, 8000 or 16000 samples/second). Declaration public event AudioSamplesReadyDelegate? AudioSamplesReady Event Type Type Description AudioSamplesReadyDelegate Implements NAudio.CoreAudioApi.Interfaces.IMMNotificationClient SipLib.Media.IAudioSampleSource"
  },
  "api/SipLib.Audio.Windows.WindowsAudioUtils.html": {
    "href": "api/SipLib.Audio.Windows.WindowsAudioUtils.html",
    "title": "Class WindowsAudioUtils",
    "summary": "Class WindowsAudioUtils Inheritance object WindowsAudioUtils Inherited Members object.Equals(object) object.Equals(object, object) object.GetHashCode() object.GetType() object.MemberwiseClone() object.ReferenceEquals(object, object) object.ToString() Namespace: SipLib.Audio.Windows Assembly: SipLib.Audio.Windows.dll Syntax public class WindowsAudioUtils Methods ReadWaveFile(string) Reads the audio samples from a WAV file. The file format must be mono, 16 bits/sample linear (PCM) and the sample rate must be 8000 or 16000 samples per second. Declaration public static AudioSampleData ReadWaveFile(string FilePath) Parameters Type Name Description string FilePath Location of the file Returns Type Description AudioSampleData Exceptions Type Condition FileNotFoundException Thrown if the file does not exist. ArgumentException Thrown if unable to read the file or if the file format is incorrect."
  },
  "api/SipLib.Audio.Windows.html": {
    "href": "api/SipLib.Audio.Windows.html",
    "title": "Namespace SipLib.Audio.Windows",
    "summary": "Namespace SipLib.Audio.Windows Classes WaveOutDest Class that implements the NAudio IWaveProvider interface for the Wave API for the NAudio class library. Applications that use class library do not normally need to use this class. WindowsAudioIo This class uses the Windows Wave API to capture audio from a microphone and to send audio to the speakers or a headset. It is intended for use with Voice Over IP (VoIP) applications running under Windows. WindowsAudioUtils Enums WaveAudioStatusEnum Enumeration for the values returned by the StartAudio method of the WindowsAudioIo class. Delegates AudioDeviceStateChangedDelegate Delegate type for the AudioDeviceStateChanged event of the WindowsAudioIo class. AudioInSamplesReadyDelegate Delegate type for the AudioInSamplesReady event of the WindowsAudioIo class."
  },
  "api/index.html": {
    "href": "api/index.html",
    "title": "SipLib.Audio.Windows Namespace",
    "summary": "SipLib.Audio.Windows Namespace This namespace contains classes that allow an application to use audio in a SIP based VoIP application that runs on a Windows PC. These classes use the Windows WAVE API via the C# wrapper classes provided by NAudio."
  },
  "articles/AudioOutput.html": {
    "href": "articles/AudioOutput.html",
    "title": "Sending Audio to the Speakers or Headset",
    "summary": "Sending Audio to the Speakers or Headset Windows applications can use the WaveAudioIo class to send blocks of 16-bit linear samples to the speakers or the headset by performing the following steps. Construct an instance of the WindowsAudioIo class. Call the StartAudio() method of the WindowsAudioIo object. Call the AudioOutSamplesReady() method of the WindowsAudioIo object every time 20 milliseconds worth of audio data has been received from the IP network. If you are using the same audio device for input and output of audio, then you must use the same instance of the WindowsAudioIo class for both receiving (capturing) and sending audio samples to the speakers or the headset. See Capturing Audio. The declaration of the constructor for the WindowsAudioIo class is: public WindowsAudioIo(int SampleRate = 8000, string? DeviceName = null); The SampleRate parameter must be either 8000 or 16000 samples per second. The DeviceName parameter must be one of the names returned by the GetAudioDeviceNames() method or null. If the DeviceName parameter is null, then the WaveAudioIo class will use the first audio device that it finds when the StartAudio() method is called. The declaration of the AudioOutSamplesReady() method is: public void AudioOutSamplesReady(short[] PcmSamples); The PcmSamples array must contain 20 milliseconds of 16-bit linear audio data. The length of this array must be 160 if the SamplerRate parameter specified in the constructor was 8000 samples/second or 320 if the specified sample rate was 16000 samples/second. The application must call the StopAudio() method when it no longer needs to send audio data to the audio device."
  },
  "articles/CapturingAudio.html": {
    "href": "articles/CapturingAudio.html",
    "title": "Capturing Audio",
    "summary": "Capturing Audio Windows applications can use the WindowsAudioIo class to capture audio from a selected audio device such as the microphone of a headset by performing the following steps. Construct an instance of the WindowsAudioIo class. Hook the AudioSamplesReady event Call the StartAudio() method of the WindowsAudioIo object. If you are using the same audio device for input and output of audio, then you must use the same instance of the WindowsAudioIo class for both receiving (capturing) and sending audio samples to the speakers or the headset. See Sending Audio to the Speakers or Headset. When the application needs to stop receiving audio, it should perform the following steps. Unhook the AudioSamplesReady event. Call the StopAudio() method of the WindowsAudioIo object. The declaration of the constructor for the WindowsAudioIo class is: public WindowsAudioIo(int SampleRate = 8000, string? DeviceName = null); The SampleRate parameter must be either 8000 or 16000 samples per second. The DeviceName parameter must be one of the names returned by the GetAudioDeviceNames() method or null. If the DeviceName parameter is null, then the WaveAudioIo class will use the first audio device that it finds when the StartAudio() method is called. The StartAudio() method returns a WaveAudioStatusEnum value to indicate success or failure. Return values of WaveAudioStatusEnum.Success and WaveAudioStatusEnum.AlreadyStarted indicate that audio sampling has been successfully started. The delegate type for the AudioSamplesReady event is: public delegate void AudioInSamplesReadyDelegate(short[] PcmSamples); The PcmSamples parameter will contain 160 linear PCM 16-bit audio samples if the SampleRate specified in the constructor was 8000 or 320 samples if the specified sample rate was 16000. This event is fired every 20 milliseconds."
  },
  "articles/EnumeratingAudioDevices.html": {
    "href": "articles/EnumeratingAudioDevices.html",
    "title": "Enumerating Audio Devices",
    "summary": "Enumerating Audio Devices The static GetAudioDeviceNames() method of the WindowsAudioIo class enumerates the available audio devices on a Windows PC. The declaration of this method is: public static List<string> GetAudioDeviceNames() This method returns a list containing the names of the audio devices that are available. The list will be empty if there are no audio devices available. The application can present this list to the application user and it can store the user's choice in the application configuration settings and use that device name the next time that it starts using the audio device. If operating in an environment where it is safe to assume there is always a single device then the application can call this method and always use the first audio device name in the returned list."
  },
  "articles/MonitoringAudioDeviceStatus.html": {
    "href": "articles/MonitoringAudioDeviceStatus.html",
    "title": "Monitoring Audio Device Status",
    "summary": "Monitoring Audio Device Status The WindowsAudioIo class has an event called AudioDeviceStateChanged that allows an application to monitor the status of the Windows PC's audio device that it is using. The delegate declaration of this event is: public delegate void AudioDeviceStateChangedDelegate(bool Connected); If Connected is false then the audio device was disconnected. If Connected is true then the audio device was connected. This event is fired only when the status of the audio device changes so it will not be fired initially if the audio device is connected when the StartAudio() method of the WaveAudioIo object is called."
  },
  "articles/intro.html": {
    "href": "articles/intro.html",
    "title": "Introduction",
    "summary": "Introduction The articles provided here describe how to perform the following functions. Enumerate the audio devices available on a Windows PC. Capture audio sample data from a selected audio device (microphone) Send audio sample data to the selected audio device (speakers or headset). Monitor the status of the Windows audio device."
  },
  "index.html": {
    "href": "index.html",
    "title": "The SipLib.Audio.Windows Class Library",
    "summary": "The SipLib.Audio.Windows Class Library This class library contains classes that provide the following functionality for using audio in SIP calls on a Windows computer. Enumerate audio devices on a Windows computer. A class for capturing audio from a microphone. A class for sending audio media to the speakers or headset. This class library can be used with the SipLib class library to build Voice over IP (VoIP) applications requiring audio support in the Windows environment. It may be used by applications or other class libraries on Windows 10, Windows 11 or Windows Server."
  }
}